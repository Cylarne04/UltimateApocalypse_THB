----------------------------------------
-- File: 'necrondeathmarkstactic.ai'
-- Created by Cylarne @ 6.28.2012

class 'NecronDeathmarksTactic' (NecronInfantryTactic)

NecronDeathmarks = {}

function NecronDeathmarksTactic:__init( squad_ai ) super( squad_ai )

	self:SetName("Necron Deathmarks Tactic")

end

function NecronDeathmarksTactic:InitAbilities()

	-- Init ability ID's
	if (NecronDeathmarks.hfhs == nil) then
		NecronDeathmarks.hfhs = cpu_manager.stats:GetAbilityID( "necron_hfhs" )
	end
	if (NecronDeathmarks.marksquad == nil) then
		NecronDeathmarks.marksquad = cpu_manager.stats:GetAbilityID( "necron_mark_squad" )
	end
end

function NecronDeathmarksTactic:DoAbilities()
	
	Ability.DoAbilityPos(self.squad_ai, NecronDeathmarks.marksquad, Ability.Filters.CloseEnemy, 3)
	Ability.DoAbilityPos(self.squad_ai, NecronDeathmarks.marksquad, Ability.Filters.CloseCommanderEnemy)
	if ((self:IsMoving() or self:IsInSubState()) and self.squad_ai:CanDoAbility( NecronDeathmarks.hfhs )) then
		if (self.squad_ai:GetHealthPercentage() > 0.4 and not self.squad_ai:IsInCombat()) then
			self.squad_ai:DoSpecialAbility(NecronDeathmarks.hfhs)
		elseif (self.squad_ai:GetHealthPercentage() <= 0.4 and self.squad_ai:IsInCombat()) then
			self.squad_ai:DoSpecialAbility(NecronDeathmarks.hfhs)
		end
	end
end
