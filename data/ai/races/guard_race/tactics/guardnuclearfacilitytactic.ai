----------------------------------------
-- File: 'GuardNuclearFacilitytactic.ai'
-- Edited by Krronus		@ 24.10.2006
-- Edited by Cylarne_04 2011

class 'GuardNuclearFacilityTactic' (BaseTactic)

GuardNuclearFacility = {}

function GuardNuclearFacilityTactic:__init( base_ai ) super( base_ai )

	self:SetName("Guard Nuclear Facility Tactic")
end

function GuardNuclearFacilityTactic:InitAbilities()

	if (GuardNuclearFacility.Nuke_id == nil) then
		GuardNuclearFacility.Nuke_id = cpu_manager.stats:GetAbilityID( "marines_nuke" )
		GuardNuclearFacility.Nuke2_id = cpu_manager.stats:GetAbilityID( "marines_nuke2" )
		GuardNuclearFacility.Nuke3_id = cpu_manager.stats:GetAbilityID( "marines_nuke3" )
		--GuardNuclearFacility.Nuke4_id = cpu_manager.stats:GetAbilityID( "guard_nuke4" )
		--GuardNuclearFacility.Global = cpu_manager.stats:GetAbilityID( "guard_nuke_global" )
	end
end

function GuardNuclearFacilityTactic:DoAbilities()

	if (self.base_ai:CanDoAbility(GuardNuclearFacility.Nuke_id)) then
		-- Activate Apocalyptic Superweapon.
		Ability.DoAbilityPos(self.base_ai, GuardNuclearFacility.Nuke2_id, Ability.Filters.CloseVehicleEnemy, 10)
		Ability.DoAbilityPos(self.base_ai, GuardNuclearFacility.Nuke_id, Ability.Filters.CloseSquadEnemy, 35)
		Ability.DoAbilityTargetEntity(self.base_ai, GuardNuclearFacility.Nuke_id, Ability.EntityFilters.CloseBaseEntityEnemy, 6)
		
		--[[if (self.base_ai:CanDoAbility(GuardNuclearFacility.Nuke3_id)) then
	
			-- Only activate if enemy unit is attacking
			local iRange = self.base_ai:GetAbilityRange(GuardNuclearFacility.Nuke3_id)
			local oSquad = Ability.Filters.CloseEnemy(self.base_ai:GetPosition(), iRange, 24)
			if (oSquad ~= nil and oSquad:IsAttacking()) then
				self.base_ai:DoSpecialAbilitySquad(GuardNuclearFacility.Nuke3_id, oSquad:GetSquad())
			end
		end]]
		--Ability.DoAbilityPos(self.base_ai, GuardNuclearFacility.Nuke4_id, Ability.Filters.CloseVehicleEnemy, 2)
		--Ability.DoAbilityPos(self.base_ai, GuardNuclearFacility.Nuke4_id, Ability.Filters.CloseEnemy, 8)
		--Ability.DoAbilityTargetEntity(self.base_ai, GuardNuclearFacility.Nuke4_id, Ability.EntityFilters.CloseBaseEntityEnemy, 1)
		
		local iRequisition = resource_manager:GetResourceAmount():Get( ResourceAmount.RT_Requisition )
		local iPower = resource_manager:GetResourceAmount():Get( ResourceAmount.RT_Power )
		
		-- Activate the planet destroyer
		--[[if (iRequisition >= 50000 and iPower >= 50000) then
			Ability.DoAbilityTargetEntity(self.base_ai, GuardNuclearFacility.Global, Ability.EntityFilters.CloseBaseEntityEnemy, 1)
		end]]
	end
	
end
